(this["webpackJsonpschool-dashoboard"]=this["webpackJsonpschool-dashoboard"]||[]).push([[143],{1845:function(e,t,n){"use strict";n.r(t);var r=n(735),s=n.n(r),a=n(736),c=n(716),o=n(1),i=n(923),u=n(38),l=n(718),d=n(76),p=n(60),b=n(14);t.default=function(){var e=Object(o.useState)(""),t=Object(c.a)(e,2),n=t[0],r=t[1],h=Object(o.useState)(""),m=Object(c.a)(h,2),f=m[0],j=m[1],v=Object(d.c)(p.d),O=Object(o.useState)(!1),x=Object(c.a)(O,2),g=x[0],N=x[1],w=[{id:"students",name:"All Students"},{id:"parents",name:"All Parents"},{id:"staff",name:"All Staff"}],k=function(){var e=Object(a.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!n||!f){e.next=16;break}N(!0),e.t0=f,e.next="staff"===e.t0?6:"students"===e.t0?9:"parents"===e.t0?12:15;break;case 6:return e.next=8,u.a.get("/teachers").then((function(e){e.data.map(function(){var e=Object(a.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.post("/chats",{message:n,telephone:t.telephone||(null===t||void 0===t?void 0:t.mobilenumber),senderID:null===v||void 0===v?void 0:v.id,userID:null===t||void 0===t?void 0:t.userID}).then((function(e){if(N(!1),e.data.error)return Object(l.c)(e.data.error),0;Object(l.m)("message send to all staff members"),r("")})).catch((function(e){N(!1),console.log(e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}));case 8:return e.abrupt("return",e.sent);case 9:return e.next=11,u.a.get("/students").then((function(e){e.data.map(function(){var e=Object(a.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.post("/chats",{message:n,userID:null===t||void 0===t?void 0:t.userID,telephone:t.telephone||(null===t||void 0===t?void 0:t.mobilenumber),senderID:null===v||void 0===v?void 0:v.id}).then((function(e){if(N(!1),e.data.error)return Object(l.c)(e.data.error),0;Object(l.m)("message send to all students"),r("")})).catch((function(e){N(!1),console.log(e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}));case 11:return e.abrupt("return",e.sent);case 12:return e.next=14,u.a.get("/students/parents").then((function(e){var t=e.data.docs;console.log(t),t.length>0?t.map(function(){var e=Object(a.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.post("/chats",{message:n,parent:t._id,userID:"parent",telephone:null===t||void 0===t?void 0:t.mobile,sender:null===v||void 0===v?void 0:v.id}).then((function(e){if(N(!1),e.data.error)return Object(l.c)(e.data.error),0;Object(l.m)("message send to all parents"),r("")})).catch((function(e){N(!1),console.log(e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):Object(l.c)("There are parents data"),N(!1)}));case 14:return e.abrupt("return",e.sent);case 15:return e.abrupt("break",16);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(b.jsx)("div",{children:Object(b.jsx)(i.a,{message:n,setmessage:r,onSend:k,recipientsOptions:w,recipient:f,setrecipient:j,sender:null===v||void 0===v?void 0:v.id,loading:g,searchOptions:function(){return w.map((function(e){return Object(b.jsx)("option",{value:e.id,children:e.name},e.id)}))},sendto:"All"})})}},735:function(e,t,n){e.exports=n(419)},736:function(e,t,n){"use strict";function r(e,t,n,r,s,a,c){try{var o=e[a](c),i=o.value}catch(u){return void n(u)}o.done?t(i):Promise.resolve(i).then(r,s)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(s,a){var c=e.apply(t,n);function o(e){r(c,s,a,o,i,"next",e)}function i(e){r(c,s,a,o,i,"throw",e)}o(void 0)}))}}n.d(t,"a",(function(){return s}))},923:function(e,t,n){"use strict";n(1);var r=n(14);t.a=function(e){var t=e.message,n=e.setmessage,s=e.onSend,a=e.recipient,c=e.setrecipient,o=e.sender,i=e.sendto,u=e.searchOptions,l=e.loading,d=e.error;return Object(r.jsxs)("form",{action:"",className:" content__container form__sender",children:[Object(r.jsx)("div",{className:"header",children:Object(r.jsxs)("h3",{children:["Send Message to ",i]})}),Object(r.jsxs)("div",{className:"row mb-2 px-3",children:[Object(r.jsx)("label",{className:"col-sm-2",htmlFor:"",children:"Recipient:"}),Object(r.jsx)("div",{className:"col-sm-10",children:Object(r.jsxs)("select",{value:a,onChange:function(e){return c(e.target.value)},id:"inputState",className:"form-select",children:[Object(r.jsx)("option",{defaultChecked:!0,hidden:!0,children:"Choose..."}),u?u():Object(r.jsx)("option",{disabled:!0,children:"No options"})]})})]}),Object(r.jsxs)("div",{className:"row mb-2 px-3",children:[Object(r.jsx)("label",{className:"col-sm-2",htmlFor:"",children:"Sender:"}),Object(r.jsx)("div",{className:"col-sm-10",children:Object(r.jsx)("input",{className:"form-control",value:o,type:"text",readOnly:!0})})]}),Object(r.jsxs)("div",{className:"mb-2 row",children:[Object(r.jsx)("div",{className:"col-12",children:Object(r.jsx)("textarea",{value:t,onChange:function(e){return n(e.target.value)},className:"form-control",name:"",rows:"10",required:!0,placeholder:"Type here"})}),d&&Object(r.jsx)("div",{className:"text-danger text-center mb-2",children:d}),Object(r.jsx)("div",{className:"col-12",children:Object(r.jsxs)("button",{disabled:l,onClick:s,className:"btn blue__btn w-100",children:[l&&Object(r.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),"Send"]})})]})]})}}}]);
//# sourceMappingURL=143.bad010ba.chunk.js.map