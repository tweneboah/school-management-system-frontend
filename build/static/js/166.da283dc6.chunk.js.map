{"version":3,"sources":["../../throttle.js","AdminComponents/messages/GuadianMessage.js","../../debounce.js","components/messages/SendToForm.js"],"names":["cancelled","lastExec","clearTimeout","arguments_","self","elapsed","Date","callback","timeoutID","debounceMode","exec","clearExistingTimeout","noTrailing","setTimeout","clear","delay","wrapper","GuadianMessage","useState","message","setmessage","recipientsOptions","setrecipientsOptions","recipient","setrecipient","sender","useSelector","selectUser","studentsList","setstudentsList","search","setsearch","sendto","autocompleteSearch","axios","get","then","res","data","error","errorAlert","users","map","user","_id","userID","name","surname","autocompleteSearchDebounced","throttle","atBegin","className","onSubmit","e","preventDefault","value","onChange","target","type","placeholder","length","option","onClick","id","console","log","docs","SendToForm","onSend","selected","find","i","mobile","post","telephone","successAlert","searchOptions","relationship","loading","action","htmlFor","defaultChecked","hidden","disabled","readOnly","rows","required","role","aria-hidden"],"mappings":"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","file":"static/js/166.da283dc6.chunk.js","sourcesContent":["/* eslint-disable no-undefined,no-param-reassign,no-shadow */\n\n/**\n * Throttle execution of a function. Especially useful for rate limiting\n * execution of handlers on events like resize and scroll.\n *\n * @param  {number}    delay -          A zero-or-greater delay in milliseconds. For event callbacks, values around 100 or 250 (or even higher) are most useful.\n * @param  {boolean}   [noTrailing] -   Optional, defaults to false. If noTrailing is true, callback will only execute every `delay` milliseconds while the\n *                                    throttled-function is being called. If noTrailing is false or unspecified, callback will be executed one final time\n *                                    after the last throttled-function call. (After the throttled-function has not been called for `delay` milliseconds,\n *                                    the internal counter is reset).\n * @param  {Function}  callback -       A function to be executed after delay milliseconds. The `this` context and all arguments are passed through, as-is,\n *                                    to `callback` when the throttled-function is executed.\n * @param  {boolean}   [debounceMode] - If `debounceMode` is true (at begin), schedule `clear` to execute after `delay` ms. If `debounceMode` is false (at end),\n *                                    schedule `callback` to execute after `delay` ms.\n *\n * @returns {Function}  A new, throttled, function.\n */\nexport default function (delay, noTrailing, callback, debounceMode) {\n\t/*\n\t * After wrapper has stopped being called, this timeout ensures that\n\t * `callback` is executed at the proper times in `throttle` and `end`\n\t * debounce modes.\n\t */\n\tlet timeoutID;\n\tlet cancelled = false;\n\n\t// Keep track of the last time `callback` was executed.\n\tlet lastExec = 0;\n\n\t// Function to clear existing timeout\n\tfunction clearExistingTimeout() {\n\t\tif (timeoutID) {\n\t\t\tclearTimeout(timeoutID);\n\t\t}\n\t}\n\n\t// Function to cancel next exec\n\tfunction cancel() {\n\t\tclearExistingTimeout();\n\t\tcancelled = true;\n\t}\n\n\t// `noTrailing` defaults to falsy.\n\tif (typeof noTrailing !== 'boolean') {\n\t\tdebounceMode = callback;\n\t\tcallback = noTrailing;\n\t\tnoTrailing = undefined;\n\t}\n\n\t/*\n\t * The `wrapper` function encapsulates all of the throttling / debouncing\n\t * functionality and when executed will limit the rate at which `callback`\n\t * is executed.\n\t */\n\tfunction wrapper(...arguments_) {\n\t\tlet self = this;\n\t\tlet elapsed = Date.now() - lastExec;\n\n\t\tif (cancelled) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Execute `callback` and update the `lastExec` timestamp.\n\t\tfunction exec() {\n\t\t\tlastExec = Date.now();\n\t\t\tcallback.apply(self, arguments_);\n\t\t}\n\n\t\t/*\n\t\t * If `debounceMode` is true (at begin) this is used to clear the flag\n\t\t * to allow future `callback` executions.\n\t\t */\n\t\tfunction clear() {\n\t\t\ttimeoutID = undefined;\n\t\t}\n\n\t\tif (debounceMode && !timeoutID) {\n\t\t\t/*\n\t\t\t * Since `wrapper` is being called for the first time and\n\t\t\t * `debounceMode` is true (at begin), execute `callback`.\n\t\t\t */\n\t\t\texec();\n\t\t}\n\n\t\tclearExistingTimeout();\n\n\t\tif (debounceMode === undefined && elapsed > delay) {\n\t\t\t/*\n\t\t\t * In throttle mode, if `delay` time has been exceeded, execute\n\t\t\t * `callback`.\n\t\t\t */\n\t\t\texec();\n\t\t} else if (noTrailing !== true) {\n\t\t\t/*\n\t\t\t * In trailing throttle mode, since `delay` time has not been\n\t\t\t * exceeded, schedule `callback` to execute `delay` ms after most\n\t\t\t * recent execution.\n\t\t\t *\n\t\t\t * If `debounceMode` is true (at begin), schedule `clear` to execute\n\t\t\t * after `delay` ms.\n\t\t\t *\n\t\t\t * If `debounceMode` is false (at end), schedule `callback` to\n\t\t\t * execute after `delay` ms.\n\t\t\t */\n\t\t\ttimeoutID = setTimeout(\n\t\t\t\tdebounceMode ? clear : exec,\n\t\t\t\tdebounceMode === undefined ? delay - elapsed : delay\n\t\t\t);\n\t\t}\n\t}\n\n\twrapper.cancel = cancel;\n\n\t// Return the wrapper function.\n\treturn wrapper;\n}\n","import React, { useState } from \"react\";\nimport SendToForm from \"../../components/messages/SendToForm\";\nimport axios from \"../../store/axios\";\nimport { errorAlert, successAlert } from \"../../utils\";\nimport { useSelector } from \"react-redux\";\nimport { selectUser } from \"../../store/slices/userSlice\";\nimport { debounce } from \"throttle-debounce\";\n\nfunction GuadianMessage() {\n  const [message, setmessage] = useState(\"\");\n  const [recipientsOptions, setrecipientsOptions] = useState([]);\n  const [recipient, setrecipient] = useState(\"\");\n  const sender = useSelector(selectUser);\n  const [studentsList, setstudentsList] = useState([]);\n  const [search, setsearch] = useState(\"\");\n  const [sendto, setsendto] = useState(\"Guadian\");\n\n  const autocompleteSearch = () => {\n    if (search) {\n      axios.get(`/students/search/${search}`).then((res) => {\n        if (res.data.error) {\n          errorAlert(res.data.error);\n          return 0;\n        }\n        setstudentsList(\n          res.data.users.map((user) => {\n            return {\n              _id: user._id,\n              userID: user.userID,\n              name: user.name,\n              surname: user.surname,\n            };\n          })\n        );\n      });\n    }\n  };\n\n  const autocompleteSearchDebounced = debounce(500, autocompleteSearch);\n\n  const onSend = (e) => {\n    e.preventDefault();\n    if (message && recipient) {\n      let selected = recipientsOptions.find((i) => i.id === recipient);\n      if (!selected?.mobile) {\n        return errorAlert(\"Parent does not have phone number\");\n      }\n\n      axios\n        .post(`/chats`, {\n          message,\n          userID: recipient,\n          telephone: selected?.mobile,\n          sender: sender?.id,\n        })\n        .then((res) => {\n          if (res.data.error) {\n            errorAlert(res.data.error);\n            return 0;\n          }\n          successAlert(\"message send\");\n          setmessage(\"\");\n        });\n    }\n  };\n\n  const handleSearchbyName = (e) => {\n    e.preventDefault();\n    autocompleteSearch();\n  };\n\n  const handleChange = (e) => {\n    setsearch(e.target.value);\n    autocompleteSearchDebounced(e.target.value);\n  };\n\n  const handleSearchParents = (id) => {\n    axios.get(`/students/parents/${id}`).then((res) => {\n      console.log(res.data);\n      if (res.data.error) {\n        errorAlert(res.data.error);\n        return 0;\n      }\n      setrecipientsOptions(res.data.docs);\n    });\n  };\n\n  const searchOptions = () => {\n    return recipientsOptions.map((option) => (\n      <option key={option.id} value={option.id}>\n        {option.name} {option.surname} {option.relationship}{\" \"}\n      </option>\n    ));\n  };\n\n  return (\n    <div>\n      <div className=\"mb-5 content__container row\">\n        <form onSubmit={handleSearchbyName} className=\"mb-5 col-12 \">\n          <label className=\"form-label\">Search for Student by Name or ID</label>\n          <div className=\"d-flex flex-row\">\n            <input\n              value={search}\n              onChange={handleChange}\n              className=\"form-control\"\n              type=\"text\"\n              placeholder=\"Type here...\"\n            />\n            <button className=\"btn blue__btn\">Search</button>\n          </div>\n          <ul className=\"students__container\">\n            {studentsList.length > 0 ? (\n              <>\n                {studentsList.map((option) => (\n                  <li\n                    onClick={() => handleSearchParents(option._id)}\n                    key={option._id}\n                    className=\"option\"\n                  >\n                    {option.name} {option.surname} {option.userID}{\" \"}\n                  </li>\n                ))}\n              </>\n            ) : (\n              <li>No results found</li>\n            )}\n          </ul>\n        </form>\n      </div>\n      {recipientsOptions.length > 0 && (\n        <SendToForm\n          message={message}\n          setmessage={setmessage}\n          onSend={onSend}\n          searchOptions={searchOptions}\n          recipient={recipient}\n          setrecipient={setrecipient}\n          sender={sender?.id}\n          sendto={sendto}\n        />\n      )}\n    </div>\n  );\n}\n\nexport default GuadianMessage;\n","/* eslint-disable no-undefined */\n\nimport throttle from './throttle';\n\n/**\n * Debounce execution of a function. Debouncing, unlike throttling,\n * guarantees that a function is only executed a single time, either at the\n * very beginning of a series of calls, or at the very end.\n *\n * @param  {number}   delay -         A zero-or-greater delay in milliseconds. For event callbacks, values around 100 or 250 (or even higher) are most useful.\n * @param  {boolean}  [atBegin] -     Optional, defaults to false. If atBegin is false or unspecified, callback will only be executed `delay` milliseconds\n *                                  after the last debounced-function call. If atBegin is true, callback will be executed only at the first debounced-function call.\n *                                  (After the throttled-function has not been called for `delay` milliseconds, the internal counter is reset).\n * @param  {Function} callback -      A function to be executed after delay milliseconds. The `this` context and all arguments are passed through, as-is,\n *                                  to `callback` when the debounced-function is executed.\n *\n * @returns {Function} A new, debounced function.\n */\nexport default function (delay, atBegin, callback) {\n\treturn callback === undefined\n\t\t? throttle(delay, atBegin, false)\n\t\t: throttle(delay, callback, atBegin !== false);\n}\n","import React from \"react\";\n\nfunction SendToForm({\n  message,\n  setmessage,\n  onSend,\n  recipient,\n  setrecipient,\n  sender,\n  sendto,\n  searchOptions,\n  loading,\n  error,\n}) {\n  return (\n    <form action=\"\" className=\" content__container form__sender\">\n      <div className=\"header\">\n        <h3>Send Message to {sendto}</h3>\n      </div>\n      <div className=\"row mb-2 px-3\">\n        <label className=\"col-sm-2\" htmlFor=\"\">\n          Recipient:\n        </label>\n        <div className=\"col-sm-10\">\n          <select\n            value={recipient}\n            onChange={(e) => setrecipient(e.target.value)}\n            id=\"inputState\"\n            className=\"form-select\"\n          >\n            <option defaultChecked hidden>\n              Choose...\n            </option>\n            {searchOptions ? (\n              searchOptions()\n            ) : (\n              <option disabled>No options</option>\n            )}\n          </select>\n        </div>\n      </div>\n\n      <div className=\"row mb-2 px-3\">\n        <label className=\"col-sm-2\" htmlFor=\"\">\n          Sender:\n        </label>\n        <div className=\"col-sm-10\">\n          <input className=\"form-control\" value={sender} type=\"text\" readOnly />\n        </div>\n      </div>\n      <div className=\"mb-2 row\">\n        <div className=\"col-12\">\n          <textarea\n            value={message}\n            onChange={(e) => setmessage(e.target.value)}\n            className=\"form-control\"\n            name=\"\"\n            rows=\"10\"\n            required\n            placeholder=\"Type here\"\n          ></textarea>\n        </div>\n        {error && <div className=\"text-danger text-center mb-2\">{error}</div>}\n        <div className=\"col-12\">\n          <button\n            disabled={loading}\n            onClick={onSend}\n            className=\"btn blue__btn w-100\"\n          >\n            {loading && (\n              <span\n                className=\"spinner-border spinner-border-sm\"\n                role=\"status\"\n                aria-hidden=\"true\"\n              ></span>\n            )}\n            Send\n          </button>\n        </div>\n      </div>\n    </form>\n  );\n}\n\nexport default SendToForm;\n"],"sourceRoot":""}