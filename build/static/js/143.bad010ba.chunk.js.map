{"version":3,"sources":["AdminComponents/messages/BulkMessage.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator/index.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","components/messages/SendToForm.js"],"names":["BulkMessage","useState","message","setmessage","recipient","setrecipient","sender","useSelector","selectUser","loading","setloading","recipientsOptions","id","name","handleSend","e","a","preventDefault","axios","get","then","res","data","map","i","post","telephone","mobilenumber","senderID","userID","response","error","errorAlert","successAlert","catch","err","console","log","re","parents","docs","length","parent","_id","mobile","onSend","searchOptions","option","value","sendto","module","exports","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","done","Promise","_asyncToGenerator","fn","self","this","args","arguments","apply","undefined","SendToForm","action","className","htmlFor","onChange","target","defaultChecked","hidden","disabled","type","readOnly","rows","required","placeholder","onClick","role","aria-hidden"],"mappings":"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","file":"static/js/143.bad010ba.chunk.js","sourcesContent":["import React, { useState } from \"react\";\nimport SendForm from \"../../components/messages/SendToForm\";\nimport axios from \"../../store/axios\";\nimport { errorAlert, successAlert } from \"../../utils\";\nimport { useSelector } from \"react-redux\";\nimport { selectUser } from \"../../store/slices/userSlice\";\n\nfunction BulkMessage() {\n  const [message, setmessage] = useState(\"\");\n  const [recipient, setrecipient] = useState(\"\");\n  const sender = useSelector(selectUser);\n  const [loading, setloading] = useState(false);\n\n  const recipientsOptions = [\n    { id: \"students\", name: \"All Students\" },\n    { id: \"parents\", name: \"All Parents\" },\n    { id: \"staff\", name: \"All Staff\" },\n  ];\n\n  // sender: sender?.id,\n\n  const searchOptions = () => {\n    return recipientsOptions.map((option) => (\n      <option key={option.id} value={option.id}>\n        {option.name}\n      </option>\n    ));\n  };\n\n  const handleSend = async (e) => {\n    e.preventDefault();\n\n    if (message && recipient) {\n      setloading(true);\n      switch (recipient) {\n        case \"staff\":\n          return await axios.get(\"/teachers\").then((res) => {\n            let staff = res.data;\n            staff.map(\n              async (i) =>\n                await axios\n                  .post(`/chats`, {\n                    message,\n                    telephone: i.telephone || i?.mobilenumber,\n                    senderID: sender?.id,\n                    userID: i?.userID,\n                  })\n                  .then((response) => {\n                    setloading(false);\n                    if (response.data.error) {\n                      errorAlert(response.data.error);\n                      return 0;\n                    }\n                    successAlert(\"message send to all staff members\");\n                    setmessage(\"\");\n                  })\n                  .catch((err) => {\n                    setloading(false);\n                    console.log(err);\n                  })\n            );\n          });\n        case \"students\":\n          return await axios.get(\"/students\").then((res) => {\n            let students = res.data;\n            students.map(\n              async (re) =>\n                await axios\n                  .post(`/chats`, {\n                    message,\n                    userID: re?.userID,\n                    telephone: re.telephone || re?.mobilenumber,\n                    senderID: sender?.id,\n                  })\n                  .then((response) => {\n                    setloading(false);\n                    if (response.data.error) {\n                      errorAlert(response.data.error);\n                      return 0;\n                    }\n                    successAlert(\"message send to all students\");\n                    setmessage(\"\");\n                  })\n                  .catch((err) => {\n                    setloading(false);\n                    console.log(err);\n                  })\n            );\n          });\n        case \"parents\":\n          return await axios.get(\"/students/parents\").then((res) => {\n            let parents = res.data.docs;\n            console.log(parents);\n            // eslint-disable-next-line no-lone-blocks\n            {\n              parents.length > 0\n                ? parents.map(\n                    async (i) =>\n                      await axios\n                        .post(`/chats`, {\n                          message,\n                          parent: i._id,\n                          userID: \"parent\",\n                          telephone: i?.mobile,\n                          sender: sender?.id,\n                        })\n                        .then((response) => {\n                          setloading(false);\n                          if (response.data.error) {\n                            errorAlert(response.data.error);\n                            return 0;\n                          }\n                          successAlert(\"message send to all parents\");\n                          setmessage(\"\");\n                        })\n                        .catch((err) => {\n                          setloading(false);\n                          console.log(err);\n                        })\n                  )\n                : errorAlert(\"There are parents data\");\n              setloading(false);\n            }\n          });\n        default:\n          break;\n      }\n    }\n  };\n\n  return (\n    <div>\n      <SendForm\n        message={message}\n        setmessage={setmessage}\n        onSend={handleSend}\n        recipientsOptions={recipientsOptions}\n        recipient={recipient}\n        setrecipient={setrecipient}\n        sender={sender?.id}\n        loading={loading}\n        searchOptions={searchOptions}\n        sendto=\"All\"\n      />\n    </div>\n  );\n}\n\nexport default BulkMessage;\n","module.exports = require(\"regenerator-runtime\");\n","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","import React from \"react\";\n\nfunction SendToForm({\n  message,\n  setmessage,\n  onSend,\n  recipient,\n  setrecipient,\n  sender,\n  sendto,\n  searchOptions,\n  loading,\n  error,\n}) {\n  return (\n    <form action=\"\" className=\" content__container form__sender\">\n      <div className=\"header\">\n        <h3>Send Message to {sendto}</h3>\n      </div>\n      <div className=\"row mb-2 px-3\">\n        <label className=\"col-sm-2\" htmlFor=\"\">\n          Recipient:\n        </label>\n        <div className=\"col-sm-10\">\n          <select\n            value={recipient}\n            onChange={(e) => setrecipient(e.target.value)}\n            id=\"inputState\"\n            className=\"form-select\"\n          >\n            <option defaultChecked hidden>\n              Choose...\n            </option>\n            {searchOptions ? (\n              searchOptions()\n            ) : (\n              <option disabled>No options</option>\n            )}\n          </select>\n        </div>\n      </div>\n\n      <div className=\"row mb-2 px-3\">\n        <label className=\"col-sm-2\" htmlFor=\"\">\n          Sender:\n        </label>\n        <div className=\"col-sm-10\">\n          <input className=\"form-control\" value={sender} type=\"text\" readOnly />\n        </div>\n      </div>\n      <div className=\"mb-2 row\">\n        <div className=\"col-12\">\n          <textarea\n            value={message}\n            onChange={(e) => setmessage(e.target.value)}\n            className=\"form-control\"\n            name=\"\"\n            rows=\"10\"\n            required\n            placeholder=\"Type here\"\n          ></textarea>\n        </div>\n        {error && <div className=\"text-danger text-center mb-2\">{error}</div>}\n        <div className=\"col-12\">\n          <button\n            disabled={loading}\n            onClick={onSend}\n            className=\"btn blue__btn w-100\"\n          >\n            {loading && (\n              <span\n                className=\"spinner-border spinner-border-sm\"\n                role=\"status\"\n                aria-hidden=\"true\"\n              ></span>\n            )}\n            Send\n          </button>\n        </div>\n      </div>\n    </form>\n  );\n}\n\nexport default SendToForm;\n"],"sourceRoot":""}