(this["webpackJsonpschool-dashoboard"]=this["webpackJsonpschool-dashoboard"]||[]).push([[152],{1186:function(e,t,c){"use strict";c(1);var n=c(14);t.a=function(){return Object(n.jsx)("div",{className:"default__chat",children:Object(n.jsxs)("div",{children:[Object(n.jsx)("h1",{children:"Welcome , Admin "}),Object(n.jsx)("h4",{children:"Messaging Chat system"})]})})}},1219:function(e,t,c){"use strict";var n=c(719),s=c(1),a=c(737),i=c.n(a),r=c(738),o=c(136),d=c(1940),l=c(38),u=c(721),j=c(32),b=c(79),h=c(14);var v=function(e){var t=e.chat,c=e.currentUser,a=Object(s.useState)({}),v=Object(n.a)(a,2),O=v[0],m=v[1],x=Object(s.useState)({}),f=Object(n.a)(x,2),p=f[0],g=f[1],_=Object(b.c)(j.i),N=Object(b.b)();Object(s.useEffect)((function(){var e=c===(null===t||void 0===t?void 0:t.requestor_id)?null===t||void 0===t?void 0:t.acceptor_id:null===t||void 0===t?void 0:t.requestor_id;l.a.get("/user/".concat(e.trim())).then((function(e){var c=e.data.user;m({profileUrl:null===c||void 0===c?void 0:c.profileUrl,name:null===c||void 0===c?void 0:c.name,surname:null===c||void 0===c?void 0:c.surname}),g(null===t||void 0===t?void 0:t.messages.pop())}))}),[t,c]);var S=function(){var e=Object(r.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.put("/chats/update/chat/".concat(t,"/").concat(c)).then((function(e){console.log(e);var t=_.filter((function(e){return"chat"!==e.type}));N(Object(j.v)(t))}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsx)("div",{className:"sidemessage",children:Object(h.jsxs)(o.b,{onClick:function(){return S(null===t||void 0===t?void 0:t._id)},to:"/messages/chat/".concat(null===t||void 0===t?void 0:t._id),className:"d-flex",children:[Object(h.jsx)("div",{className:"mr-2",children:Object(h.jsx)(d.a,{alt:Object(u.h)((null===O||void 0===O?void 0:O.name)||"O"),src:Object(u.g)(null===O||void 0===O?void 0:O.profileUrl)})}),Object(h.jsxs)("div",{children:[Object(h.jsxs)("div",{className:"d-flex align-center justify-content-between w-100",children:[Object(h.jsxs)("h6",{children:[Object(u.d)(null===O||void 0===O?void 0:O.name)," ",(null===O||void 0===O?void 0:O.surname)&&Object(u.i)(Object(u.d)(null===O||void 0===O?void 0:O.surname),5)]}),Object(h.jsx)("small",{className:"text-muted",children:Object(u.n)(null===p||void 0===p?void 0:p.date)})]}),Object(h.jsx)("span",{children:Object(u.i)((null===p||void 0===p?void 0:p.message)||"last message...",20)})]})]})})},O=c(60),m=c(1274),x=c.n(m),f=c(80),p=c(753),g=c(103),_=c(941),N=c(825),S=c(909),y=c(917),C=c(926),w=c(1780),D=c(742),k=c.n(D),I=c(1500),U=c(1122),q=c.n(U),R=c(1133),A=c.n(R),E=c(567),F=Object(g.a)((function(e){return{root:{margin:0,padding:e.spacing(2)},icon:{width:"50px",height:"50px"},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}}))((function(e){var t=e.children,c=e.classes,n=e.onClose,s=Object(p.a)(e,["children","classes","onClose"]);return Object(h.jsxs)(S.a,Object(f.a)(Object(f.a)({disableTypography:!0,className:c.root},s),{},{children:[Object(h.jsx)(I.a,{variant:"h6",children:t}),n?Object(h.jsx)(w.a,{"aria-label":"close",className:c.closeButton,onClick:n,children:Object(h.jsx)(k.a,{})}):null]}))})),W=Object(g.a)((function(e){return{root:{padding:e.spacing(2)}}}))(y.a),z=Object(g.a)((function(e){return{root:{margin:0,padding:e.spacing(1)}}}))(C.a);function B(e){var t=e.open,c=e.setOpen,n=e.search,s=e.setsearch,a=e.handleSearch,i=e.loadingSearch,r=e.searchResults,o=e.loading,d=e.handleSendRequest,l=e.setsearchResults,u=function(){s(""),l(""),c(!1)};return Object(h.jsx)("div",{children:Object(h.jsxs)(N.a,{fullWidth:!0,maxWidth:"sm",onClose:u,"aria-labelledby":"customized-dialog-title",open:t,children:[Object(h.jsx)(F,{id:"customized-dialog-title",onClose:u,children:"Find User"}),Object(h.jsxs)(W,{children:[Object(h.jsx)("form",{action:"",onSubmit:a,children:Object(h.jsxs)("div",{className:"search__user",children:[Object(h.jsxs)("div",{children:[Object(h.jsx)(q.a,{}),Object(h.jsx)("input",{value:n,onChange:function(e){return s(e.target.value)},type:"text",placeholder:"Search by name or userID"})]}),n&&!i&&Object(h.jsx)(A.a,{onClick:function(){s("")}}),Object(h.jsx)("div",{children:i&&Object(h.jsx)(E.a,{style:{width:"20px",height:"20px"}})})]})}),Object(h.jsxs)("div",{className:"mt-3 d-flex results__container justify-content-between align-items-start",children:[Object(h.jsx)("ul",{children:r&&r.map((function(e){return Object(h.jsx)("li",{children:Object(h.jsxs)("button",{onClick:function(){return d(null===e||void 0===e?void 0:e.userID)},className:"btn",children:[e.name," ",e.surname," - ",e.userID]})})}))}),o&&Object(h.jsx)(E.a,{style:{width:"20px",height:"20px"}})]})]}),Object(h.jsx)(z,{children:Object(h.jsx)(_.a,{autoFocus:!0,onClick:u,color:"primary",children:"Close"})})]})})}t.a=function(){var e=Object(s.useState)([]),t=Object(n.a)(e,2),c=t[0],a=t[1],i=Object(b.c)(O.d),r=Object(s.useState)(!1),o=Object(n.a)(r,2),d=o[0],j=o[1],m=Object(s.useState)(""),f=Object(n.a)(m,2),p=f[0],g=f[1],_=Object(s.useState)(""),N=Object(n.a)(_,2),S=N[0],y=N[1],C=Object(s.useState)(!1),w=Object(n.a)(C,2),D=w[0],k=w[1],I=Object(s.useState)(!1),U=Object(n.a)(I,2),q=U[0],R=U[1];return Object(s.useEffect)((function(){l.a.get("/chats/chats/".concat(null===i||void 0===i?void 0:i.id)).then((function(e){a(e.data)}))}),[i]),Object(h.jsxs)("div",{className:"sidebar",children:[Object(h.jsx)("div",{className:"sidebar__header p-2 mb-2",children:Object(h.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[Object(h.jsx)("h5",{children:Object(h.jsx)("strong",{children:"Chats"})}),Object(h.jsx)("div",{children:Object(h.jsx)("button",{onClick:function(){return j(!0)},className:"btn",children:Object(h.jsx)(x.a,{})})})]})}),Object(h.jsx)("div",{children:c&&c.sort((function(e,t){return e.updatedAt-t.updatedAt})).map((function(e){return Object(h.jsx)(v,{chat:e,currentUser:null===i||void 0===i?void 0:i.id},e._id)}))}),Object(h.jsx)(B,{search:p,setsearch:g,handleSearch:function(e){console.log("search"),e.preventDefault(),p&&(k(!0),l.a.get("/users/search/".concat(p)).then((function(e){var t=e.data;k(!1),y(t)})).catch((function(e){console.log(e),R(!1)})))},open:d,searchResults:S,setsearchResults:y,loadingSearch:D,setOpen:j,loading:q,handleSendRequest:function(e){R(!0),l.a.post("/chats/create",{acceptor_id:e,requestor_id:null===i||void 0===i?void 0:i.userID}).then((function(e){if(R(!1),e.data.error)return Object(u.c)(e.data.error);j(!1),l.a.get("/chats/chats/".concat(null===i||void 0===i?void 0:i.userID)).then((function(e){a(e.data)}))})).catch((function(e){Object(u.c)("Faild"),R(!1)}))}})]})}},1220:function(e,t,c){"use strict";var n=c(737),s=c.n(n),a=c(738),i=c(719),r=c(1),o=c.n(r),d=c(721),l=c(14);var u=function(e){var t=e.message,c=e.currentUser;return Object(l.jsxs)("div",{className:c===(null===t||void 0===t?void 0:t.senderID)?"sender__mesaage message":"message",children:[Object(l.jsx)("div",{className:"message__content",children:null===t||void 0===t?void 0:t.message}),Object(l.jsx)("div",{className:"message__time ",children:Object(d.n)(t.date)})]})},j=c(22),b=c(38),h=c(79),v=c(60),O=c(1940);t.a=function(){var e=Object(j.i)().id,t=Object(r.useState)([]),c=Object(i.a)(t,2),n=c[0],m=c[1],x=Object(r.useState)(""),f=Object(i.a)(x,2),p=f[0],g=f[1],_=Object(r.useState)({}),N=Object(i.a)(_,2),S=N[0],y=N[1],C=Object(h.c)(v.d),w=o.a.createRef();Object(r.useEffect)((function(){D()}));var D=function(){w.current.scrollIntoView({behavior:"smooth"})};return Object(r.useEffect)((function(){b.a.get("/chats/chat/".concat(e)).then(function(){var e=Object(a.a)(s.a.mark((function e(t){var c,n,a,i,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(null===(c=t.data)||void 0===c?void 0:c.messages),r=(null===C||void 0===C?void 0:C.id)===(null===(n=t.data)||void 0===n?void 0:n.requestor_id)?null===(a=t.data)||void 0===a?void 0:a.acceptor_id:null===(i=t.data)||void 0===i?void 0:i.requestor_id,e.next=4,b.a.get("/user/".concat(r)).then((function(e){y(e.data.user)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e,C]),Object(l.jsxs)("div",{className:"message__container",children:[Object(l.jsxs)("div",{className:"header d-flex",children:[Object(l.jsx)(O.a,{src:Object(d.g)(null===S||void 0===S?void 0:S.profileUrl),alt:Object(d.h)((null===S||void 0===S?void 0:S.name)||"U")}),Object(l.jsxs)("div",{className:"ml-3",children:[Object(l.jsxs)("h6",{children:[" ",Object(d.d)((null===S||void 0===S?void 0:S.name)||"A")," ",Object(d.d)(null===S||void 0===S?void 0:S.surname)]}),Object(l.jsx)("span",{children:null===S||void 0===S?void 0:S.userID})]})]}),Object(l.jsxs)("div",{className:"message__messages p-2",children:[n&&n.map((function(e){return Object(l.jsx)(u,{message:e,currentUser:null===C||void 0===C?void 0:C.id},e._id)})),Object(l.jsx)("div",{ref:w})]}),Object(l.jsxs)("form",{onSubmit:function(t){t.preventDefault(),p&&b.a.put("/chats/send/".concat(e),{message:p,senderID:null===C||void 0===C?void 0:C.id,channelID:e}).then((function(e){var t;console.log(e.data),m(null===(t=e.data.doc)||void 0===t?void 0:t.messages),g("")}))},className:"send",children:[Object(l.jsx)("input",{value:p,onChange:function(e){return g(e.target.value)},type:"text",placeholder:"Type here ..."}),Object(l.jsx)("button",{type:"submit",className:"btn",children:"Send"})]})]})}},1793:function(e,t,c){"use strict";c.r(t);c(1);var n=c(22),s=c(1219),a=c(1220),i=c(1186),r=c(14);t.default=function(){return Object(r.jsx)("div",{children:Object(r.jsxs)("div",{className:" messages__container ",children:[Object(r.jsx)(s.a,{}),Object(r.jsx)("div",{className:"containing__chat",children:Object(r.jsxs)(n.d,{children:[Object(r.jsx)(n.b,{component:a.a,path:"/messages/chat/:id"}),Object(r.jsx)(n.b,{component:i.a,path:"/messages/chat"})]})})]})})}}}]);
//# sourceMappingURL=152.64bd286e.chunk.js.map